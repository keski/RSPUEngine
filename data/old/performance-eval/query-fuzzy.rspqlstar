# Query demonstrating the fuzzy uncertainty type over a single event stream.
# Reports the degree to which either HighHeartRateEvent OR VeryHighHeartRateEvent is true

BASE <http://base/>
PREFIX ecare: <http://www.example.org/ecare#>
PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
PREFIX sosa: <http://www.w3.org/ns/sosa/>
PREFIX rspu: <http://w3id.org/rsp/rspu#>

REGISTER STREAM <fuzzy> COMPUTED EVERY PT1S AS

SELECT (COUNT(?event) AS ?count)
#?event ?hr ?state ?degree1 ?degree2 ?unc
FROM NAMED WINDOW <w> ON <http://ecareathome/stream/heartrate> [RANGE PT1S STEP PT1S]
WHERE {
   WINDOW <w> {
      GRAPH ?g {
          ?event a ecare:HeartRateEvent .
          ?event sosa:hasSimpleResult ?hr .
          << ?event a ?node >> rspu:hasState ?state .
          << ?event a ecare:HighHeartRateEvent >> rspu:degreeOfTruth ?degree1 .
          << ?event a ecare:VeryHighHeartRateEvent >> rspu:degreeOfTruth ?degree2 .
          # Fuzzy
          BIND(rspu:disjunction(?degree1, ?degree2) AS ?unc)
      }
   }
}